<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Planificateur d'itinéraires dans SCR !</title>
</head>
<body>

<h2>Planificateur d'itinéraires</h2>

<label for="start">Départ :</label>
<select id="start">
  <option value="">-- Choisir un arrêt --</option>
</select>

<label for="end">Arrivée :</label>
<select id="end">
  <option value="">-- Choisir un arrêt --</option>
</select>

<button id="searchBtn">Chercher itinéraires directs</button>

<h3>Résultats :</h3>
<ul id="results"></ul>

<script>
// Tableau complet corrigé des routes (extrait corrigé, tu peux ajouter le reste)
const routes = [
  
  {"routeId":"R001","type":"Connect","stops":["Stepford Central","Stepford East","St Helens Bridge","Bodin","Coxly","Benton","Benton Bridge","Stepford Airport Parkway","Stepford Airport Central"]},
  {"routeId":"R002","type":"Metro","stops":["Stepford Central","Four Ways","Stepford East","Stepford High Street","St Helens Bridge","Angel Pass","Bodin","Coxly","Benton","Port Benton"]},
  {"routeId":"R003","type":"Connect","stops":["Stepford Central","Stepford East","St Helens Bridge","Angel Pass","Bondin","Coxly","Benton","Benton Bridge","Hampton Hargate","Upper Staploe","Water Newton","Rocket Parade","Leighton Stepford Road","Leighton City"]},
  {"routeId":"R004","type":"Connect","stops":["St Helens Bridge","Bodin","Coxly","Benton","Benton Bridge","Hampton Hargate","Water Newton","Leighton Stepford Road","Leighton City","Edgemead"]},
  {"routeId":"R005","type":"Connect","stops":["Stepford Victoria","Financial Quarter","Stepford Central","Stepford East","Saint Helen's Bridge","Bodin","Coxly","Benton","Benton Bridge","Stepford Airport Parkway","Stepford Airport Central"]},
  {"routeId":"R006","type":"Metro","stops":["Stepford Victoria","Financial Quartier","City Hospital","Stepford Central","Four Ways","Stepford East","Stepford High Street","Saint Helen's Bridge","Angel Pass","Bodin","Coxly","Benton","Port Benton"]},
  {"routeId":"R007","type":"Connect","stops":["Stepford Central","Stepford East","Saint Helen's Bridge","Elsemere Junction","Berrily","Morganstown"]},
  {"routeId":"R008","type":"Metro","stops":["Stepford Victoria","Financial Quartier","City Hoqpital","Stepford Central","Four Ways","Stepford East","Stepford High Street","Saint Helen's Bridge","New Harrow","Elsemere Pound","Elsemere Junction","Berrily"]},
  {"routeId":"R009","type":"Connect","stops":["Stepford Victoria","Stepford Central","Stepford East","Saint Helen's Bridge","Bodin","Coxly","Benton","Benton Bridge","Hampton Hargate","Water Newton","Rocket Parade","Leighton Stepford Road","Leighton City","Eadgemead"]},
  {"routeId":"R010","type":"Waterline","stops":["Greenslade","Whitney Green","Morganstown Docks","Port Benton","Benton","West Benton","Faraday Road","Eden Quay","Newry"]},
  {"routeId":"R011","type":"Waterline","stops":["Connoly","Ashlan Park","Cambridge Street Parkway","Benton","West Benton","Faraday Road","Eden Quay","Newry"]},
  {"routeId":"R012","type":"Waterline","stops":["Connoly","Ashlan Park","Cambridge Street Parkway","Benton","West Benton","Faraday Road","Eden Quay","Newry","Newry Harbour"]},
  {"routeId":"R013","type":"Waterline","stops":["Greenslade","Whitney Green","Morganstown Docks","Port Benton","Benton"]},
  {"routeId":"R014","type":"Waterline","stops":["Esterfield","Farleigh","Airport West","Cambridge Street Parkway","Benton","West Benton","Faraday Road","Eden Quay","Newry"]},
  {"routeId":"R015","type":"Waterline","stops":["Morganstown","Morganstown Docks","Port Benton","Benton"]},
  {"routeId":"R016","type":"Waterline","stops":["Esterfield","Rosedale Village","Farleigh","James Street","Airport West","Cambridge Street Parkway","Benton"]},
  {"routeId":"R017","type":"Waterline","stops":["Terminal 2","Airport West","Cambridge Street Parkway","Benton","West Benton","Faraday Road","Eden Quay","Newry"]},
  {"routeId":"R018","type":"Waterline","stops":["Farlaigh","James Street","Airport West","Cambridge Street Parkway","Benton","West Benton","Faraday Road","Eden Quay","Newry","Newry Harbour"]},
  {"routeId":"R019","type":"Waterline","stops":["Connoly","Ashlan Park","Cambridge Street Parkway","Benton"]},
  {"routeId":"R020","type":"Connect","stops":["Whitefield","Houghton Rake","Woodhead Lane","Stepford United Football Club","Stepford East","Stepford Central"]},
  {"routeId":"R021","type":"Metro","stops":["Stepford Central","Four Ways","Stepford East","Stepford High Street","Whitefield Lido","Stepford United Football Club"]},
  {"routeId":"R022","type":"Connect","stops":["Beechley","Stepford Central","Stepford East","Stepford United Football Club","Woodhead Lane","Houghton Rake","Whitefield"]},
  {"routeId":"R023","type":"Metro","stops":["Stepford Victoria","Financial Quarter","City Hospital","Stepford Central","Four Ways","Stepford East","Stepford High Street","Whitefield Lido","Stepford United Football Club"]},
  {"routeId":"R024","type":"Connect","stops":["Stepford Central","Stepford East","Saint Helen's Bridge","Bodin","Coxly","Benton","Benton Bridge","Hampton Hargate","Water Newton","Rocket Parade","Leighton Stepford Road","Leighton City","Edgemead","Fayemere","Westercoast","Milcastle","Westwyvern","Starrylock","Northshore","Llyn-by-the-Sea"]},
  {"routeId":"R025","type":"Connect","stops":["St Helens Bridge","Bodin","Coxly","Benton","Benton Bridge","Hampton Hargate","Upper Staploe","Water Newton","Rocket Parade","Leighton Stepford Road","Leighton City","Edgemead","Fayemere","Westercoast","Milcastle Racecourse","Milcastle","Westwyvern"]},
  {"routeId":"R026","type":"Connect","stops":["Stepford Victoria","Stepford Central","Stepford East","Saint Helen's Bridge","Bodin","Coxly","Benton","Benton Bridge","Hampton Hargate","Water Newton","Leighton Stepford Road","Leighton City","Edgemead","Westercoast","Milcastle","Westwyvern","Northshore","Llyn-by-the-Sea"]},
  {"routeId":"R027","type":"Metro","stops":["Stepford Central","Four Ways","Stepford East","Stepford High Street","Saint Helen's Bridge","New Harrow","Elsemere Pound","Elsemere Junction","Berrily"]},
  {"routeId":"R028","type":"Metro","stops":["Willowfield","Hedmon Park","Beechley","Financial Quartier","Stepford Victoria"]},
  {"routeId":"R029","type":"Metro","stops":["Stepford Victoria","Financial Quarter","Beechley"]},
  {"routeId":"R030","type":"Metro","stops":["Willowfield","Hedmon Park","Beechley","City Hospital","Stepford Central","Four Ways","Stepford East","Stepford High Street","Saint Helen's Bridge","New Harrow","Elsemere Pound","Elsemere Junction","Berrily"]},
  {"routeId":"R031","type":"Metro","stops":["Willowfield","Hedmon Park","Beechley","City Hospital","Stepford Central","Four Ways","Stepford East","Stepford High Street","Whitefield Lido","Stepford United Football Club"]},
  {"routeId":"R032","type":"Connect","stops":["Willowfield","Beechley","Stepford Central","Stepford East","Saint Helen's Bridge","Bodin","Coxly","Benton","Port Benton"]},
  {"routeId":"R033","type":"Metro","stops":["Beechley","Stepford Central","Stepford East","Saint Helen's Bridge","Bodin","Coxly","Benton","Benton Bridge","Airport Parkway","Airport Central"]},
  {"routeId":"R034","type":"Metro","stops":["Beechley","City Hospital","Stepford Central","Four Ways","Stepford East","Stepford High Street","Saint Helen's Bridge","New Harrow","Elsemere Pound","Elsemere Junction","Berrily","East Berrily","Beaulieu Park","Morganstown"]},
  {"routeId":"R035","type":"Connect","stops":["Willowfield","Beechley","Stepford Central","Stepford East","St Helens Bridge","Bodin","Coxly","Benton","Benton Bridge","Hampton Hargate","Water Newton","Rocket Parade","Leighton Stepford Road","Leighton City","Edgemead","Fayemere","Westercoast","Milcastle","Westwyvern"]},
  {"routeId":"R036","type":"Connect","stops":["Willowfield","Beechley","Stepford Central","Stepford East","Saint Helen's Bridge","Bodin","Coxly","Benton","Hampton Hargate","Water Newton","Leighton Stepford Road","Leighton City","Edgemead","Westercoast","Milcastle","Westwyvern","Northshore","Llyn-by-the-Sea"]},
  {"routeId":"R037","type":"Connect","stops":["Leighton City","Edgemead","Fayemere","Westercoast","Milcastle","Westwyvern","Northshore","Llyn-by-the-Sea"]},
  {"routeId":"R038","type":"Connect","stops":["Leighton City","Edgemead","Fayemere","Westercoast","Milcastle","Westwyvern"]},
  {"routeId":"R039","type":"Connect","stops":["Benton","Benton Bridge","Hampton Hargate","Upper Staploe","Water Newton","Rocket Parade","Leighton Stepford Road","Leighton City"]},
  {"routeId":"R040","type":"Connect","stops":["Edgemead","Fayemere","Westercoast","Milcastle","Westwyvern","Starrylock","Northshore","Llyn-by-the-Sea"]},
  {"routeId":"R041","type":"Connect","stops":["Leighton West","Edgemead"]},
  {"routeId":"R042","type":"Connect","stops":["Leighton West","Edgemead","Fayemere","Westercoast","Milcastle","Westwyvern","Starrylock","Northshore","Llyn-by-the-Sea"]},
  {"routeId":"R043","type":"Connect","stops":["Leighton West","Leighton City"]},
  {"routeId":"R044","type":"Connect","stops":["Benton","Benton Bridge","Hampton Hargate","Upper Staploe","Water Newton","Rocket Parade","Leighton Stepford Road","Leighton City","Leighton West"]}
];

// Extraire la liste unique de tous les arrêts
const allStopsSet = new Set();
routes.forEach(route => {
  route.stops.forEach(stop => allStopsSet.add(stop));
});
const allStops = Array.from(allStopsSet).sort();

// Remplir les menus déroulants avec les arrêts
function populateSelectOptions(selectId, stops) {
  const select = document.getElementById(selectId);
  stops.forEach(stop => {
    const option = document.createElement("option");
    option.value = stop;
    option.textContent = stop;
    select.appendChild(option);
  });
}

populateSelectOptions("start", allStops);
populateSelectOptions("end", allStops);

// Fonction pour trouver les routes directes dans les 2 sens
function findDirectRoutes(routes, fromStop, toStop) {
  return routes.filter(route => {
    const fromIndex = route.stops.indexOf(fromStop);
    const toIndex = route.stops.indexOf(toStop);
    return fromIndex !== -1 && toIndex !== -1 && fromIndex !== toIndex;
  });
}

document.getElementById("searchBtn").addEventListener("click", () => {
  const fromStop = document.getElementById("start").value;
  const toStop = document.getElementById("end").value;
  const resultsEl = document.getElementById("results");
  resultsEl.innerHTML = "";

  if (!fromStop || !toStop) {
    resultsEl.innerHTML = "<li>Merci de choisir un arrêt de départ et un arrêt d'arrivée.</li>";
    return;
  }

  if (fromStop === toStop) {
    resultsEl.innerHTML = "<li>Le départ et l'arrivée doivent être différents.</li>";
    return;
  }

  const foundRoutes = findDirectRoutes(routes, fromStop, toStop);

  if (foundRoutes.length === 0) {
    resultsEl.innerHTML = "<li>Aucun itinéraire direct trouvé.</li>";
  } else {
    foundRoutes.forEach(route => {
      const fromIndex = route.stops.indexOf(fromStop);
      const toIndex = route.stops.indexOf(toStop);

      // Trier les indices pour extraire le segment correct
      const start = Math.min(fromIndex, toIndex);
      const end = Math.max(fromIndex, toIndex);

      const segmentStops = route.stops.slice(start, end + 1);

      const li = document.createElement("li");

      let content = `${route.routeId} (${route.type}) : `;

      segmentStops.forEach((stop, i) => {
        if (i === 0 || i === segmentStops.length - 1) {
          // Départ ou arrivée en normal
          content += `<span style="font-weight: normal;">${stop}</span>`;
        } else {
          // Intermédiaires en italique et plus petits
          content += `<span style="font-style: italic; font-size: smaller;"> → ${stop}</span>`;
        }
        // Ajouter une flèche après départ seulement, pas après les intermédiaires (déjà dans le texte)
        if (i === 0 && segmentStops.length > 1) {
          content += " → ";
        }
      });

      li.innerHTML = content;
      resultsEl.appendChild(li);
    });
  }
});
</script>

</body>
</html>
